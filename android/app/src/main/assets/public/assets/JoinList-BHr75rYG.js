import{u as p,c as y,b as c,a as N,j as e,k as f}from"./index-DkDPUQpr.js";import{k as w,f as I,d as n,L as x}from"./react-vendor-BToC6Ez8.js";import"./originals-sdk-C0s467Ca.js";function D(){const{listId:t,token:s}=w(),m=I(),{did:a,isAuthenticated:u,isLoading:h}=p(),g=y(c.invites.acceptInvite),[r,l]=n.useState(!1),[o,d]=n.useState(null),[v]=n.useState(()=>Date.now()),i=N(c.invites.validateInvite,t&&s?{listId:t,token:s,currentTime:v}:"skip");if(!u)return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(f,{embedded:!0}),e.jsx("div",{className:"text-center text-gray-500 -mt-4 pb-8",children:"Sign in to join this list."})]});if(h||i===void 0)return e.jsx("div",{className:"text-center py-12",children:e.jsx("div",{className:"text-gray-500",children:"Validating invite..."})});if(!i.valid)return e.jsxs("div",{className:"max-w-md mx-auto text-center py-12 bg-white rounded-lg shadow p-6",children:[e.jsx("div",{className:"text-red-500 text-5xl mb-4",children:":("}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Invalid Invite"}),e.jsx("p",{className:"text-gray-500 mb-4",children:i.error}),e.jsx(x,{to:"/",className:"text-blue-600 hover:text-blue-700",children:"Go to your lists"})]});const b=async()=>{if(!(!a||!t||!s)){l(!0),d(null);try{await g({listId:t,token:s,userDid:a,currentTime:Date.now()}),m(`/list/${t}`)}catch(j){console.error("Failed to join list:",j),d("Failed to join list. Please try again."),l(!1)}}};return e.jsxs("div",{className:"max-w-md mx-auto text-center py-12 bg-white rounded-lg shadow p-6",children:[e.jsx("div",{className:"mb-4 p-2 bg-gray-100 rounded text-xs font-mono text-left",children:e.jsxs("div",{children:["Your DID: ",a??"null"]})}),e.jsx("div",{className:"text-5xl mb-4",children:"+"}),e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:[`You're invited to join "`,i.listName,'"']}),e.jsx("p",{className:"text-gray-500 mb-6",children:"Accept this invite to start collaborating on the list."}),o&&e.jsx("p",{className:"mb-4 text-sm text-red-600",children:o}),e.jsxs("div",{className:"flex gap-3 justify-center",children:[e.jsx(x,{to:"/",className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-md font-medium hover:bg-gray-200",children:"Cancel"}),e.jsx("button",{onClick:b,disabled:r,className:"px-6 py-2 bg-blue-600 text-white rounded-md font-medium hover:bg-blue-700 disabled:opacity-50",children:r?"Joining...":"Join List"})]})]})}export{D as JoinList};
